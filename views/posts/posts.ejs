<%- include ("../partials/header"); %>

<div class="page_content">
    
<h1 style="margin: 0 auto;" class="my-4">View Posts</h1>
<% if (isAuthenticated) { %>
    <div class="col-md-6" style="align-self: center;">
        <a class="btn btn-success mt-5 mb-5" href="/posts/create">Create a Post</a>
    </div>

<% } %>

<% if(typeof posts !== 'undefined'){ %>
    <div class="blog_posts_container">
        <% posts.forEach(function(post) { %>

            <div class="col-md-6">
                <div class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
                  <div class="col p-4 d-flex flex-column position-static">
                    <!-- <strong class="d-inline-block mb-2 text-primary">World</strong> -->
                    <h3 class="mb-0"><%= post.title %></h3>
                    <div class="mb-1 text-muted"><%= post.createdAt.toLocaleDateString('en-us', { weekday:"long", year:"numeric", month:"short", day:"numeric"})  %>  </div>
                    <hr class="my-1">
                    <p class="card-text mb-auto"><%= post.body %></p>
                    <a href="/posts/<%= post.id %>" class="stretched-link mt-1" >Read Full Post</a>
                  </div>
                  <!-- <div class="col-auto d-none d-lg-block">
                      Read More
                  </div> -->
                </div>
            </div>
        <% }); %>
    </div>

    <div class="mb-5 mt-3" style="margin: 0 auto;">
        <ul class="pagination">

            <% if (currentPage == 1) { %>
                <li class="page-item disabled">
                    <a class="page-link" href="#">&laquo;</a>
                </li>
            <% } else { %>
                <li class="page-item">
                    <a class="page-link" href="#">&laquo;</a>
                </li>
            <% } %>

            <% for( let page = 1; page < numPages+1; page++ ) { %>
                <% if (page == currentPage) { %>
                    <li class="page-item active">
                        <a class="page-link" href="/posts/?page=<%= page %>"><%= page %> </a>
                    </li>
                <% } else { %>
                    <li class="page-item">
                        <a class="page-link" href="/posts/?page=<%= page %>"><%= page %> </a>
                    </li>
                <% } %>
            <% } %>                     

            <% if (currentPage == numPages) { %>
                <li class="page-item disabled">
                    <a class="page-link" href="#">&raquo;</a>
                </li>
            <% } else { %>
                <li class="page-item">
                    <a class="page-link" href="#">&raquo;</a>
                </li>
            <% } %>

        </ul>
      </div>
<% } %>

</div>